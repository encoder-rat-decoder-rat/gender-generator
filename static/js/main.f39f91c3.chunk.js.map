{"version":3,"sources":["dataStore.js","visuals.js","index.js"],"names":["baseCategories","categorySets","categorySort","a","b","length","sets","index","addNewCategory","label","size","newCategoryIndex","newCategory","addToSet","categorySet","concat","sort","Math","min","random","round","pairSets","map","multiSets","push","COLORS","width","document","documentElement","clientWidth","height","clientHeight","chart","VennDiagram","duration","svg","select","append","attr","filter","createGooyFilter","vennWrapper","style","addOne","window","setInterval","nodes","serializedCategories","serializeCategories","datum","call","selectAll","d","i","orientation","PI","setTimeout"],"mappings":"0LAAaA,EAAiB,GACjBC,EAAe,GAErB,SAASC,EAAaC,EAAGC,GAE9B,IAAMC,EAASF,EAAEG,KAAKD,OAASD,EAAEE,KAAKD,OACtC,GAAe,IAAXA,EACF,OAAOA,EAIT,IAAK,IAAIE,EAAQ,EAAGA,EAAQJ,EAAEG,KAAKD,OAAQE,GAAS,EAClD,OAAOJ,EAAEG,KAAKC,GAASH,EAAEE,KAAKC,GAGhC,OAAO,EAkBF,SAASC,EAAeC,EAAOC,GACpC,IAAMC,EAAmBX,EAAeK,OAElCO,EAAc,CAClBN,KAAM,CAACK,GACPF,QACAC,QAGIG,EAAW,SAACC,GAAD,MAAkB,CAEjCR,KAAMQ,EAAYR,KAAKS,OAAO,CAACJ,IAAmBK,OAClDN,KAEEO,KAAKC,IAAIR,EAAMI,EAAYJ,MAE3BO,KAAKE,SACL,GAGAF,KAAKG,MAAsB,IAAhBH,KAAKE,YAIdE,EAAWrB,EAAesB,IAAIT,GAE9BU,EAAYtB,EAAaqB,IAAIT,GAGnCb,EAAewB,KAAKZ,GAEpBX,EAAauB,KAAb,MAAAvB,EAAY,YAASoB,GAAT,mBAAsBE,KC1B7B,IAAME,EAAS,CACpB,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,SACA,UACA,UCvCF,IAAIC,EAAQC,SAASC,gBAAgBC,YACnCC,EAASH,SAASC,gBAAgBG,aAG9BC,EAAQC,wBAAcP,MAAMA,GAAOI,OAAOA,GAAQI,SAAS,KAG3DC,EAAMC,YAAO,QAChBC,OAAO,OACPC,KAAK,QAASZ,GACdY,KAAK,SAAUR,ID1BX,SAA0BK,GAG/B,IACII,EADOJ,EAAIE,OAAO,QACJA,OAAO,UAAUC,KAAK,KAAM,mBAC9CC,EACGF,OAAO,kBACPC,KAAK,KAAM,iBACXA,KAAK,eAAgB,KAErBA,KAAK,8BAA+B,QACpCA,KAAK,SAAU,QAClBC,EACGF,OAAO,iBACPC,KAAK,KAAM,QACXA,KAAK,OAAQ,UACbA,KAAK,SAAU,gDACfA,KAAK,SAAU,SCWpBE,CAAiBL,GAGjB,IAAIM,EAAcN,EACfE,OAAO,KACPC,KAAK,QAAS,eACdA,KAAK,KAAM,eACXI,MAAM,SAAU,yBA0BnB,SAASC,IAAuC,IAAhCjC,EAA+B,uDAAR,GAAhBO,KAAKE,SAAgB,EAC1CX,EAAe,GAAIE,GARrBkC,OAAOC,aAdP,WAEE,IAAMC,EF3BD,WACL,IAAMC,EAAuB/C,EAAee,OAAOd,GAInD,OAHA8C,EAAqB/B,KAAKd,GAGnB6C,EAAqBR,QAAO,qBAAG7B,QEsBxBsC,GACdP,EAAYQ,MAAMH,GAAOI,KAAKlB,GDgB9BmB,YAAU,qBACPT,MAAM,eAAgB,IACtBA,MAAM,QAAQ,SAAUU,EAAGC,GAC1B,OAAO5B,EAAO4B,MAIlBF,YAAU,uBAAuBT,MAAM,UAAW,QClBlDV,EAAMsB,YAAYtB,EAAMsB,cAAgBrC,KAAKsC,GAAK,KAMrB,KAY/B,IAAK,IAAIF,EAAI,EAAGA,EAAI,GAAIA,GAAK,EAC3BT,OAAOY,WAAWb,EAAQ,KAAOU,K","file":"static/js/main.f39f91c3.chunk.js","sourcesContent":["export const baseCategories = [];\nexport const categorySets = [];\n\nexport function categorySort(a, b) {\n  // Sort in order of set length\n  const length = a.sets.length - b.sets.length;\n  if (length !== 0) {\n    return length;\n  }\n  // And if they're the same length,\n  // sort in order of the indexes in the sets\n  for (let index = 0; index < a.sets.length; index += 1) {\n    return a.sets[index] - b.sets[index];\n  }\n\n  return 0;\n}\n\n/**\n * Function to take our category stores and turn it into a format usable by D3\n */\nexport function serializeCategories() {\n  const serializedCategories = baseCategories.concat(categorySets);\n  serializedCategories.sort(categorySort);\n\n  // Only pass categories with overlaps\n  return serializedCategories.filter(({ size: setSize }) => setSize);\n}\n\n/**\n * Adds a new category to our list of categories and generates\n * intersections for each of the existing categories\n */\nexport function addNewCategory(label, size) {\n  const newCategoryIndex = baseCategories.length;\n  // Add itself to the base categories\n  const newCategory = {\n    sets: [newCategoryIndex],\n    label,\n    size,\n  };\n\n  const addToSet = (categorySet) => ({\n    // Sort the sets in place for ease of the serializer\n    sets: categorySet.sets.concat([newCategoryIndex]).sort(),\n    size:\n      // The size of the sets cannot be larger than either of the categories\n      Math.min(size, categorySet.size) *\n      // Randomize the size of the overlap\n      Math.random() *\n      0.6 *\n      // TODO: Figure out how often we want overlaps\n      // Math.round(Math.random() * X) basically says we get overlaps less than half the time\n      Math.round(Math.random() * 0.78),\n  });\n\n  // Now duplicate the existing pair sets\n  const pairSets = baseCategories.map(addToSet);\n  // Now duplicate the existing multi sets\n  const multiSets = categorySets.map(addToSet);\n\n  // Finally add the new category to the base categories\n  baseCategories.push(newCategory);\n  // And the new pari and multi sets\n  categorySets.push(...pairSets, ...multiSets);\n}\n","import { selectAll } from \"d3\";\n\n///////////////////////////////////////////////////////////////////////////\n///////////////////////////// Create filter ///////////////////////////////\n///////////////////////////////////////////////////////////////////////////\n\nexport function createGooyFilter(svg) {\n  //SVG filter for the gooey effect\n  //Code taken from http://tympanus.net/codrops/2015/03/10/creative-gooey-effects/\n  var defs = svg.append(\"defs\");\n  var filter = defs.append(\"filter\").attr(\"id\", \"gooeyCodeFilter\");\n  filter\n    .append(\"feGaussianBlur\")\n    .attr(\"in\", \"SourceGraphic\")\n    .attr(\"stdDeviation\", \"5\")\n    //to fix safari: http://stackoverflow.com/questions/24295043/svg-gaussian-blur-in-safari-unexpectedly-lightens-image\n    .attr(\"color-interpolation-filters\", \"sRGB\")\n    .attr(\"result\", \"blur\");\n  filter\n    .append(\"feColorMatrix\")\n    .attr(\"in\", \"blur\")\n    .attr(\"mode\", \"matrix\")\n    .attr(\"values\", \"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7\")\n    .attr(\"result\", \"gooey\");\n  //If you want the end shapes to be exactly the same size as without the filter\n  //add the feComposite below. However this will result in a less beautiful gooey effect\n  //filter.append(\"feBlend\")\n  //  .attr(\"in\",\"SourceGraphic\")\n  //  .attr(\"in2\",\"gooey\");\n  //Instead of the feBlend, you can do feComposite. This will also place a sharp image on top\n  //But it will result in smaller circles\n  //filter.append(\"feComposite\") //feBlend\n  //  .attr(\"in\",\"SourceGraphic\")\n  //  .attr(\"in2\",\"gooey\")\n  //  .attr(\"operator\",\"atop\");\n}\n\n// temporary pastel scheme\nexport const COLORS = [\n  \"#fce9f1\",\n  \"#FEC8D8\",\n  \"#FFDFD3\",\n  \"#e9fcf4\",\n  \"#feece8\",\n  \"#e8fafe\",\n  \"#ece8fe\",\n  \"#efbbcf\",\n  \"#ffd5cd\",\n  \"#FFCCDD\",\n  \"#FFFFCC\",\n  \"#FFDDCC\",\n  \"#CCDDEE\",\n  \"#FFCCCC\",\n  \"#CCDDCC\",\n  \"#CCFFCC\",\n  \"#FFEEFF\",\n  \"#CCCCFF\",\n  \"#CAEEFE\",\n  \"#FFFCE7\",\n  \"E1FFD4\",\n  \"#FCE1F8\",\n  \"DACBFE\",\n];\n\nexport function colorCircles(wrapper) {\n  selectAll(\".venn-circle path\")\n    .style(\"fill-opacity\", 0.5)\n    .style(\"fill\", function (d, i) {\n      return COLORS[i];\n    });\n\n  // Hide those labels, for now\n  selectAll(\".venn-circle .label\").style(\"display\", \"none\");\n}\n","import \"./index.css\";\n\nimport { select } from \"d3\";\n\nimport { VennDiagram } from \"venn.js\";\n\nimport { serializeCategories, addNewCategory } from \"./dataStore.js\";\n\nimport { createGooyFilter, colorCircles } from \"./visuals.js\";\n\n///////////////////////////////////////////////////////////////////////////\n///////////////////////////////////////////////////////////////////////////\n/////////////////////////////// Reference ////////////////////////////////////\n///////////////////////////////////////////////////////////////////////////\n// http://bl.ocks.org/nbremer/0e98c72b043590769facc5e829ebf43f\n// http://bl.ocks.org/syntagmatic/6a921aed54be2a2bea5e56cf2157768b\n// https://www.visualcinnamon.com/2016/06/fun-data-visualizations-svg-gooey-effect\n\n///////////////////////////////////////////////////////////////////////////\n/////////////////////////////// Set-up ////////////////////////////////////\n///////////////////////////////////////////////////////////////////////////\n\nvar width = document.documentElement.clientWidth,\n  height = document.documentElement.clientHeight;\n\n// Generate the Chart\nconst chart = VennDiagram().width(width).height(height).duration(2000);\n\n// Create the SVG that houses the chart\nconst svg = select(\"body\")\n  .append(\"svg\")\n  .attr(\"width\", width)\n  .attr(\"height\", height);\n\ncreateGooyFilter(svg);\n\n// The wrapper for all of the circles\nvar vennWrapper = svg\n  .append(\"g\")\n  .attr(\"class\", \"vennWrapper\")\n  .attr(\"id\", \"vennWrapper\")\n  .style(\"filter\", \"url(#gooeyCodeFilter)\");\n\n/**\n * This updates our data and recalls the colorizing function\n */\nfunction updateData() {\n  // Fetch our data\n  const nodes = serializeCategories();\n  vennWrapper.datum(nodes).call(chart);\n\n  // Update all of the colors\n  colorCircles();\n\n  chart.orientation(chart.orientation() + Math.PI / 8);\n}\n\n/**\n * A setInterval loop to update our page every second\n */\nwindow.setInterval(updateData, 1000);\n\n/**\n * Add a random circle\n *\n * @param      {Number}  [size=Math.random()*14+8]  The size\n */\nfunction addOne(size = Math.random() * 14 + 8) {\n  addNewCategory(\"\", size);\n}\n\n// Add a new category every 2.5 seconds up to 10\nfor (let i = 0; i < 10; i += 1) {\n  window.setTimeout(addOne, 2500 * i);\n}\n"],"sourceRoot":""}